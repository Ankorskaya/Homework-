# quest.py — простой текстовый квест с ветвлениями и возможностью повторить игру

def intro():
    print("Ты стоишь у развилки в тёмном лесу.")
    print("Налево — слышны голоса и свет, направо — туман и странный шёпот.")
    print()

def choose_path():
    choice = input("Куда пойдёшь? (лево/право/назад) ").strip().lower()
    if choice == "лево":
        return "left"
    elif choice == "право":
        return "right"
    elif choice == "назад" or choice == "back":
        return "back"
    else:
        print("Не понял выбор — попробуй ещё раз.")
        return choose_path()

def left_path():
    print("\nНалево ты выходишь на поляночку с костром и странными путниками.")
    talk = input("Подойти и заговорить? (да/нет) ").strip().lower()
    if talk == "да":
        print("Они приветливы и дают тебе карту. Ты чувствуешь облегчение.")
        # ещё одно ветвление
        take_map = input("Взять карту? (да/нет) ").strip().lower()
        if take_map == "да":
            print("Карта указывает на скрытую тропу. Удача улыбается тебе — ты выиграл!")
            return "win"
        else:
            print("Ты отказываешься — путники исчезают. Ты остаёшься с сомнениями и возвращаешься домой.")
            return "home"
    else:
        print("Ты обошёл их стороной. По пути назад наступила ночь.")
        return "night"

def right_path():
    print("\nНаправо туман сгущается. Шёпот зовёт по имени.")
    shout = input("Кричишь в ответ или идёшь тихо? (кричать/тихо) ").strip().lower()
    if shout == "кричать":
        print("Твой крик разгоняет туман — из него вырывается тёмная тень!")
        fight = input("Драться или бежать? (драться/бежать) ").strip().lower()
        if fight == "драться":
            print("Ты сражаешься и побеждаешь — добыча тёмной тени становится твоим талисманом.")
            return "talisman"
        else:
            print("Ты бежишь и находишь безопасный домик. Спасён, но без трофеев.")
            return "safe"
    else:
        print("Шёпот ведёт тебя к озеру. На его берегу — зеркало.")
        look = input("Глядеть в зеркало? (да/нет) ").strip().lower()
        if look == "да":
            print("В зеркале ты видишь своё лучшее «я». Это урок — ты возвращаешься мудрее.")
            return "wise"
        else:
            print("Ты проходишь мимо и теряешься в тумане. Конец путешествия.")
            return "lost"

def main():
    while True:
        intro()
        path = choose_path()

        if path == "left":
            result = left_path()
        elif path == "right":
            result = right_path()
        else:
            print("\nТы решил вернуться домой, и приключение отложено.")
            result = "home"

        # ещё одно обобщающее ветвление по результату
        if result == "win":
            print("\nПоздравляем — ты нашёл сокровище и закончил квест успешно!\n")
        elif result == "talisman":
            print("\nТы получаешь талисман и силу. Конец с новой силой!\n")
        elif result == "wise":
            print("\nМудрость важнее богатства. Ты вернулся другим человеком.\n")
        elif result == "home":
            print("\nТы благополучно вернулся домой. Бывает и такое приключение.\n")
        else:
            print("\nПутешествие окончилось загадочно. Попробуй снова, может найдёшь новый путь.\n")

        again = input("Сыграть ещё раз? (да/нет) ").strip().lower()
        if again != "да":
            print("Спасибо за игру — до встречи!")
            break

if __name__ == "__main__":
    main()
